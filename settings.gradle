/*
 * This file was generated by the Gradle 'init' task.
 *
 * The settings file is used to specify which projects to include in your build.
 * 
 * Detailed information about configuring a multi-project build in Gradle can be found
 * in the user guide at https://docs.gradle.org/4.7/userguide/multi_project_builds.html
 */

rootProject.name = 'netbeans'
include 'nbbuild'

//include 'org.netbeans.insane-test'
//project(':org.netbeans.insane-test').projectDir = new File(rootDir, 'harness/o.n.insane')
//project(':org.netbeans.insane-test').buildFileName = "build-test.gradle"
//project(':org.netbeans.insane-test').projectDir = new File(rootDir, 'harness/o.n.insane-test')

def clusterDirs = [\
    'apisupport', \
    'enterprise', \
    'ergonomics',
    'extide',
    'groovy',
    'harness',
    'ide',
    'java',
    'javafx',
    'nb',
    'nbi',
    'php',
    'platform',
    'profiler',
    'webcommon',
    'websvccommon'
]

clusterDirs.each() { cluster ->
    new File(rootDir, cluster).eachDir { sub -> 
        File projectXML = new File (sub, 'nbproject/project.xml')
        if (projectXML.canRead()) {
            def prj = new XmlSlurper().parse(projectXML)
            if ('org.netbeans.modules.apisupport.project'.equals(prj.type.text())) {
                def name = prj.configuration.data['code-name-base'].text()
                include name
                project(":$name").projectDir = sub
                if (new File(sub, 'build-test.gradle').exists()) {
                    include "$name-test"
                    project(":$name-test").projectDir = sub
                    project(":$name-test").buildFileName = 'build-test.gradle'
                }
            }
        }
    }
}
