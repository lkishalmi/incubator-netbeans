/*
 * This file was generated by the Gradle 'init' task.
 *
 * The settings file is used to specify which projects to include in your build.
 * 
 * Detailed information about configuring a multi-project build in Gradle can be found
 * in the user guide at https://docs.gradle.org/4.7/userguide/multi_project_builds.html
 */

rootProject.name = 'netbeans'
include 'nbbuild'

def excludedModules = [
    'org.openide.util.enumerations'
]

def clusterDirs = [\
    'apisupport', \
    'enterprise', \
    'ergonomics',
    'extide',
    'groovy',
    'harness',
    'ide',
    'java',
    'javafx',
    'nb',
    'nbi',
    'php',
    'platform',
    'profiler',
    'webcommon',
    'websvccommon'
]

clusterDirs.each() { cluster ->
    new File(rootDir, cluster).eachDir { sub -> 
        File projectXML = new File (sub, 'nbproject/project.xml')
        if (projectXML.canRead()) {
            def prj = new XmlSlurper().parse(projectXML)
            if ('org.netbeans.modules.apisupport.project'.equals(prj.type.text())) {
                def name = prj.configuration.data['code-name-base'].text()
                if (!excludedModules.contains(name)) {
                    include name
                    project(":$name").projectDir = sub
                    def testDir = new File(sub.getParentFile(), "${sub.getName()}-test")
                    if (testDir.isDirectory()) {
                        include "$name-test"
                        project(":$name-test").projectDir = testDir
                    }
                }
            }
        }
    }
}
